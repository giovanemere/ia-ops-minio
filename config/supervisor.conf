[supervisord]
nodaemon=true
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

[program:minio]
command=/usr/local/bin/minio server /data --console-address ":9001"
user=appuser
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/minio.log
stderr_logfile=/app/logs/minio.log
environment=MINIO_ROOT_USER="minioadmin",MINIO_ROOT_PASSWORD="minioadmin123"

[program:minio-api]
command=python api/main.py
user=appuser
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/api.log
stderr_logfile=/app/logs/api.log
environment=MINIO_ENDPOINT="localhost:9000",MINIO_ACCESS_KEY="minioadmin",MINIO_SECRET_KEY="minioadmin123"

[program:portal]
command=python portal/app.py
user=appuser
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/portal.log
stderr_logfile=/app/logs/portal.log

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stdout_logfile=/app/logs/nginx.log
stderr_logfile=/app/logs/nginx.log

[program:setup-buckets]
command=/bin/bash scripts/setup-buckets.sh
user=appuser
directory=/app
autostart=true
autorestart=false
startsecs=0
stdout_logfile=/app/logs/setup.log
stderr_logfile=/app/logs/setup.log

[program:docs]
command=mkdocs serve --config-file mkdocs.yml --dev-addr=0.0.0.0:6541 --no-livereload
user=appuser
directory=/app
autostart=true
autorestart=true
stdout_logfile=/app/logs/docs.log
stderr_logfile=/app/logs/docs.log
environment=PYTHONPATH="/app",GIT_PYTHON_REFRESH="quiet"
